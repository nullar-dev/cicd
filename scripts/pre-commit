#!/bin/sh
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  âš¡ Nullar pre-commit-hook âš¡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "  âš¡ Nullar pre-commit-hook âš¡"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo " âš¡ Running pre-commit checks..."
echo ""

# ANSI colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Run lint
echo " ${BLUE}ğŸ” Running ESLint...${NC}"
pnpm run lint
if [ $? -ne 0 ]; then
    echo ""
    echo " ${RED}âŒ LINT FAILED${NC}"
    echo " ${YELLOW}Fix with: pnpm run format && pnpm run lint${NC}"
    exit 1
fi

# Run format
echo " ${BLUE}ğŸ¨ Checking formatting...${NC}"
pnpm run format
if [ $? -ne 0 ]; then
    echo ""
    echo " ${RED}âŒ FORMAT FAILED${NC}"
    echo " ${YELLOW}Fix with: pnpm run format${NC}"
    exit 1
fi

# Run lint-staged to format only staged files
pnpm lint-staged

# Run typecheck
echo " ${BLUE}ğŸ”¦ Running TypeScript...${NC}"
pnpm run typecheck
if [ $? -ne 0 ]; then
    echo ""
    echo " ${RED}âŒ TYPECHECK FAILED${NC}"
    exit 1
fi

# Run tests
echo " ${BLUE}ğŸ§ª Running tests...${NC}"
pnpm run test
if [ $? -ne 0 ]; then
    echo ""
    echo " ${RED}âŒ TESTS FAILED${NC}"
    exit 1
fi

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "  ${GREEN}âœ… All checks passed! Ready to commit!${NC}"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
